---
apiVersion: argoproj.io/v1alpha1
kind: WorkflowTemplate
metadata:
  name: basemaps-vector-etl
  namespace: argo
spec:
  entrypoint: vector-etl
  arguments:
    parameters:
      - name: target
        value: "linz-basemaps"
        enum:
          - "linz-basemaps"
          - "linz-basemaps-staging"
  templateDefaults:
    container:
      imagePullPolicy: Always
  templates:
    - name: vector-etl
      container:
        image: 019359803926.dkr.ecr.ap-southeast-2.amazonaws.com/eks:bm-etl-latest
        resources:
          requests:
            memory: 7.8Gi
            cpu: 15000m
        command: [node, index.cjs]
        env:
          - name: AWS_ROLE_CONFIG_PATH
            value: s3://linz-bucket-config/config.basemaps.json
        args:
          ["--all", "--target", "{{workflow.parameters.target}}", "--commit"]
